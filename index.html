<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ü–µ–Ω–∫–∞ –≤–≤–æ–¥–∞ —Ç–æ–≤–∞—Ä–∞ –≤ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</title>
    <style>
        :root {
            --color-primary: #2c5aa0;
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-danger: #ef4444;
            --color-bg: #f8f9fa;
            --color-surface: #ffffff;
            --color-border: #dee2e6;
        }
        
        .auth-screen { min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .auth-box { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); max-width: 400px; width: 90%; }
        .auth-box h2 { color: var(--color-primary); text-align: center; margin-bottom: 30px; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 16px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .modal-header { padding: 25px; border-bottom: 2px solid var(--color-border); display: flex; justify-content: space-between; align-items: center; }
        .modal-header h2 { color: var(--color-primary); margin: 0; }
        .modal-body { padding: 25px; }
        .modal-close { background: none; border: none; font-size: 28px; cursor: pointer; color: #999; }
        .modal-close:hover { color: #333; }
        
        .products-table { width: 100%; border-collapse: collapse; font-size: 13px; }
        .products-table th { background: var(--color-primary); color: white; padding: 12px; text-align: left; position: sticky; top: 0; }
        .products-table td { padding: 12px; border-bottom: 1px solid var(--color-border); }
        .products-table tr:hover { background: #f8f9fa; }
        .status-badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 700; }
        .status-approved { background: var(--color-success); color: white; }
        .status-pending { background: var(--color-warning); color: white; }
        .status-rejected { background: var(--color-danger); color: white; }
        
        .file-upload { border: 2px dashed var(--color-border); border-radius: 12px; padding: 40px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .file-upload:hover { border-color: var(--color-primary); background: #f8f9fa; }
        .file-upload.dragover { border-color: var(--color-primary); background: #e7f3ff; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--color-bg); color: #333; line-height: 1.6; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        .header { background: linear-gradient(135deg, var(--color-primary), #1e3a8a); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header h1 { font-size: 28px; margin-bottom: 10px; }
        .header p { opacity: 0.9; font-size: 14px; }
        
        .product-info { background: var(--color-surface); padding: 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .product-info h2 { color: var(--color-primary); font-size: 18px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--color-primary); }
        
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: 600; font-size: 13px; margin-bottom: 6px; color: #555; }
        .form-group input, .form-group select { padding: 10px 12px; border: 2px solid var(--color-border); border-radius: 8px; font-size: 14px; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1); }
        
        .block { background: var(--color-surface); padding: 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .block-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 2px solid var(--color-primary); }
        .block-title { color: var(--color-primary); font-size: 18px; font-weight: 700; }
        .block-score { font-size: 24px; font-weight: 800; }
        .block-score.pass { color: var(--color-success); }
        .block-score.fail { color: var(--color-danger); }
        
        .criteria-grid { display: grid; gap: 15px; }
        .criterion { display: grid; grid-template-columns: 2fr 1fr 1fr 120px; gap: 15px; align-items: center; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .criterion-name { font-weight: 500; font-size: 14px; }
        .criterion-info { font-size: 12px; color: #666; }
        .criterion-input input { width: 100%; padding: 8px; border: 2px solid var(--color-border); border-radius: 6px; text-align: center; }
        .criterion-score { text-align: center; font-weight: 700; font-size: 16px; }
        
        .result-panel { position: sticky; top: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
        .result-panel h2 { font-size: 20px; margin-bottom: 20px; }
        .total-score { font-size: 64px; font-weight: 900; text-align: center; margin: 20px 0; text-shadow: 2px 2px 8px rgba(0,0,0,0.2); }
        .decision { text-align: center; font-size: 24px; font-weight: 700; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 8px; margin-top: 20px; }
        .decision.accept { background: var(--color-success); }
        .decision.reject { background: var(--color-danger); }
        .decision.review { background: var(--color-warning); }
        
        .block-scores { margin-top: 20px; }
        .block-score-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.2); }
        
        .buttons { display: flex; gap: 15px; margin-top: 20px; }
        .btn { flex: 1; padding: 15px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-calculate { background: var(--color-success); color: white; }
        .btn-calculate:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4); }
        .btn-reset { background: #6c757d; color: white; }
        .btn-reset:hover { background: #5a6268; }
        
        .help-text { font-size: 11px; color: #666; margin-top: 4px; }
        
        .info-box { background: #e7f3ff; border-left: 4px solid var(--color-primary); padding: 15px; border-radius: 6px; margin: 20px 0; }
        .info-box strong { color: var(--color-primary); }
        
        @media (max-width: 768px) {
            .criterion { grid-template-columns: 1fr; }
            .result-panel { position: static; }
        }
        
        .conditions-section { background: #fff8dc; padding: 20px; border-radius: 10px; margin-top: 25px; border: 2px solid #ffd700; }
        .conditions-section h3 { color: #ff8c00; margin-bottom: 15px; }
        
        .legend { display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px; font-size: 12px; }
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .legend-color { width: 20px; height: 20px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ü–∞–Ω–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div id="loginScreen" class="auth-screen">
            <div class="auth-box">
                <h2>üîê –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="user@example.com">
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button class="btn btn-calculate" onclick="login()" style="width: 100%;">–í–æ–π—Ç–∏</button>
                <div style="margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 8px; font-size: 12px;">
                    <strong>–î–µ–º–æ-–¥–æ—Å—Ç—É–ø:</strong><br>
                    –ú–µ–Ω–µ–¥–∂–µ—Ä: manager@store.ru / pass123<br>
                    –î–∏—Ä–µ–∫—Ç–æ—Ä: director@store.ru / pass123<br>
                    –ê–¥–º–∏–Ω: admin@store.ru / pass123
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
        <div id="mainApp" style="display: none;">
            <div class="header">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h1>üìä –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –≤–≤–æ–¥–∞ —Ç–æ–≤–∞—Ä–∞ –≤ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</h1>
                        <p>–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –∏ —Ä–∏—Å–∫–æ–≤</p>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; margin-bottom: 5px;">
                            üë§ <span id="currentUserName"></span> (<span id="currentUserRole"></span>)
                        </div>
                        <button class="btn btn-reset" onclick="logout()" style="width: auto; padding: 8px 16px;">–í—ã–π—Ç–∏</button>
                    </div>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                    <button class="btn btn-calculate" onclick="showImportModal()" style="width: auto;">
                        üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ Excel
                    </button>
                    <button class="btn btn-calculate" onclick="showProductsList()" style="width: auto; background: #3b82f6;">
                        üìã –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ (<span id="productsCount">0</span>)
                    </button>
                    <button class="btn btn-calculate" onclick="exportToExcel()" style="width: auto; background: #10b981;">
                        üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                    <button class="btn btn-calculate" onclick="showNewProductForm()" style="width: auto; background: #8b5cf6;">
                        ‚ûï –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä
                    </button>
                    <button class="btn btn-calculate" onclick="showUserManagement()" id="userManagementBtn" style="width: auto; background: #ec4899; display: none;">
                        üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
                    </button>
                </div>
            </div>
        
        <div style="display: grid; grid-template-columns: 1fr 350px; gap: 25px;">
            <div>
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ -->
                <div class="product-info">
                    <h2>üìù –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                            <input type="text" id="productName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ô–æ–≥—É—Ä—Ç –ø–∏—Ç—å–µ–≤–æ–π">
                        </div>
                        <div class="form-group">
                            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                            <input type="text" id="productCategory" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ–ª–æ—á–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è">
                        </div>
                        <div class="form-group">
                            <label>–ü–æ—Å—Ç–∞–≤—â–∏–∫</label>
                            <input type="text" id="supplierName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞">
                        </div>
                    </div>
                </div>
                
                <!-- –ë–õ–û–ö 1: –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å -->
                <div class="block">
                    <div class="block-header">
                        <div class="block-title">üí∞ –ë–õ–û–ö 1: –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div>
                        <div class="block-score" id="block1Score">0 / 43</div>
                    </div>
                    <div class="info-box">
                        <strong>–ú–∏–Ω–∏–º—É–º –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</strong> ‚â•35 –±–∞–ª–ª–æ–≤ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –±–ª–æ–∫!)
                    </div>
                    <div class="criteria-grid">
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ (%)</div>
                                <div class="criterion-info">–ú–∏–Ω: ‚â•30% | –í–µ—Å: 10%</div>
                            </div>
                            <div class="criterion-input">
                                <input type="number" id="markup" step="0.1" placeholder="30">
                            </div>
                            <div class="criterion-info">‚â•30% = 10 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="markupScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å (%)</div>
                                <div class="criterion-info">–ú–∏–Ω: ‚â•15% | –í–µ—Å: 10%</div>
                            </div>
                            <div class="criterion-input">
                                <input type="number" id="margin" step="0.1" placeholder="15">
                            </div>
                            <div class="criterion-info">‚â•15% = 10 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="marginScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π GMROI</div>
                                <div class="criterion-info">–ú–∏–Ω: ‚â•1.5 | –í–µ—Å: 8%</div>
                            </div>
                            <div class="criterion-input">
                                <input type="number" id="gmroi" step="0.1" placeholder="1.5">
                            </div>
                            <div class="criterion-info">‚â•1.5 = 8 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="gmroiScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂ (—à—Ç/–º–µ—Å)</div>
                                <div class="criterion-info">–ú–∏–Ω: ‚â•150 —à—Ç | –í–µ—Å: 7%</div>
                            </div>
                            <div class="criterion-input">
                                <input type="number" id="volume" placeholder="150">
                            </div>
                            <div class="criterion-info">‚â•150 = 7 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="volumeScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º–∞—è –≤—ã—Ä—É—á–∫–∞ (—Ä—É–±/–º–µ—Å)</div>
                                <div class="criterion-info">–ú–∏–Ω: ‚â•25000 —Ä—É–± | –í–µ—Å: 8%</div>
                            </div>
                            <div class="criterion-input">
                                <input type="number" id="revenue" placeholder="25000">
                            </div>
                            <div class="criterion-info">‚â•25000 = 8 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="revenueScore">0</div>
                        </div>
                    </div>
                </div>
                
                <!-- –ë–õ–û–ö 2: –†—ã–Ω–æ—á–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª -->
                <div class="block">
                    <div class="block-header">
                        <div class="block-title">üìà –ë–õ–û–ö 2: –†—ã–Ω–æ—á–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</div>
                        <div class="block-score" id="block2Score">0 / 18</div>
                    </div>
                    <div class="info-box">
                        <strong>–ú–∏–Ω–∏–º—É–º –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</strong> ‚â•12 –±–∞–ª–ª–æ–≤
                    </div>
                    <div class="criteria-grid">
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ï–º–∫–æ—Å—Ç—å —Ä—ã–Ω–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
                                <div class="criterion-info">1-–Ω–∏–∑–∫–∞—è, 3-—Å—Ä–µ–¥–Ω—è—è, 5-–≤—ã—Å–æ–∫–∞—è | –í–µ—Å: 5%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="marketCapacity">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –ù–∏–∑–∫–∞—è</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –°—Ä–µ–¥–Ω—è—è</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –í—ã—Å–æ–∫–∞—è</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 5 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="marketCapacityScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ù–∞–ª–∏—á–∏–µ —Å–ø—Ä–æ—Å–∞</div>
                                <div class="criterion-info">0-–Ω–µ—Ç, 3-—É–º–µ—Ä–µ–Ω–Ω—ã–π, 5-–≤—ã—Å–æ–∫–∏–π | –í–µ—Å: 6%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="demand">
                                    <option value="0">0 - –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –£–º–µ—Ä–µ–Ω–Ω—ã–π</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –í—ã—Å–æ–∫–∏–π</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 6 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="demandScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤</div>
                                <div class="criterion-info">0-–µ—Å—Ç—å, 3-—á–∞—Å—Ç–∏—á–Ω–æ, 5-—É–Ω–∏–∫–∞–ª–µ–Ω | –í–µ—Å: 4%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="uniqueness">
                                    <option value="0">0 - –ï—Å—Ç—å –∞–Ω–∞–ª–æ–≥–∏</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –ß–∞—Å—Ç–∏—á–Ω–æ</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –£–Ω–∏–∫–∞–ª–µ–Ω</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 4 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="uniquenessScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç—å —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</div>
                                <div class="criterion-info">1-–Ω–µ—Ç, 3-—É —á–∞—Å—Ç–∏, 5-—É –≤—Å–µ—Ö | –í–µ—Å: 3%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="competition">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –ù–µ—Ç —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –£ —á–∞—Å—Ç–∏</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –£ –≤—Å–µ—Ö</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 3 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="competitionScore">0</div>
                        </div>
                    </div>
                </div>
                
                <!-- –ë–õ–û–ö 3: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
                <div class="block">
                    <div class="block-header">
                        <div class="block-title">‚öôÔ∏è –ë–õ–û–ö 3: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
                        <div class="block-score" id="block3Score">0 / 17</div>
                    </div>
                    <div class="info-box">
                        <strong>–ú–∏–Ω–∏–º—É–º –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</strong> ‚â•12 –±–∞–ª–ª–æ–≤
                    </div>
                    <div class="criteria-grid">
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏ (–¥–Ω–µ–π)</div>
                                <div class="criterion-info">–ú–∏–Ω: ‚â•14 –¥–Ω–µ–π | –í–µ—Å: 4%</div>
                            </div>
                            <div class="criterion-input">
                                <input type="number" id="shelfLife" placeholder="14">
                            </div>
                            <div class="criterion-info">‚â•14 = 4 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="shelfLifeScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (SQI)</div>
                                <div class="criterion-info">1-10 –±–∞–ª–ª–æ–≤ | –í–µ—Å: 5%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="supplierReliability">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•7 = 5 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="supplierReliabilityScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–£—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏</div>
                                <div class="criterion-info">1-–Ω–µ—É–¥–æ–±–Ω–æ, 3-–ø—Ä–∏–µ–º–ª–µ–º–æ, 5-–æ—Ç–ª–∏—á–Ω–æ | –í–µ—Å: 3%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="deliveryTerms">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –ù–µ—É–¥–æ–±–Ω–æ</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –ü—Ä–∏–µ–º–ª–µ–º–æ</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –û—Ç–ª–∏—á–Ω–æ</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 3 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="deliveryTermsScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–û–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å –∑–∞–ø–∞—Å–æ–≤ (–¥–Ω–µ–π)</div>
                                <div class="criterion-info">–ú–∞–∫—Å: ‚â§30 –¥–Ω–µ–π | –í–µ—Å: 5%</div>
                            </div>
                            <div class="criterion-input">
                                <input type="number" id="turnover" placeholder="30">
                            </div>
                            <div class="criterion-info">‚â§30 = 5 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="turnoverScore">0</div>
                        </div>
                    </div>
                </div>
                
                <!-- –ë–õ–û–ö 4: –†–∏—Å–∫–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–æ -->
                <div class="block">
                    <div class="block-header">
                        <div class="block-title">üõ°Ô∏è –ë–õ–û–ö 4: –†–∏—Å–∫–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–æ</div>
                        <div class="block-score" id="block4Score">0 / 12</div>
                    </div>
                    <div class="info-box">
                        <strong>–ú–∏–Ω–∏–º—É–º –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</strong> ‚â•9 –±–∞–ª–ª–æ–≤ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π –±–ª–æ–∫!)
                    </div>
                    <div class="criteria-grid">
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–†–µ–ø—É—Ç–∞—Ü–∏—è –±—Ä–µ–Ω–¥–∞/–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è</div>
                                <div class="criterion-info">1-5 –±–∞–ª–ª–æ–≤ | –í–µ—Å: 4%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="brandReputation">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –ü–ª–æ—Ö–∞—è</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –°—Ä–µ–¥–Ω—è—è</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –û—Ç–ª–∏—á–Ω–∞—è</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 4 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="brandReputationScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–ù–∞–ª–∏—á–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
                                <div class="criterion-info">0-–Ω–µ—Ç, 5-–ø–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç | –í–µ—Å: 5%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="certification">
                                    <option value="0">0 - –ù–µ—Ç</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –ü–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç</option>
                                </select>
                            </div>
                            <div class="criterion-info">5 = 5 –±–∞–ª–ª–æ–≤</div>
                            <div class="criterion-score" id="certificationScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–†–∏—Å–∫ –ø–æ—Ä—á–∏/–ø–æ—Ç–µ—Ä—å</div>
                                <div class="criterion-info">1-–≤—ã—Å–æ–∫–∏–π, 3-—Å—Ä–µ–¥–Ω–∏–π, 5-–Ω–∏–∑–∫–∏–π | –í–µ—Å: 3%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="spoilageRisk">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –í—ã—Å–æ–∫–∏–π</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –ù–∏–∑–∫–∏–π</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 3 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="spoilageRiskScore">0</div>
                        </div>
                    </div>
                </div>
                
                <!-- –ë–õ–û–ö 5: –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ -->
                <div class="block">
                    <div class="block-header">
                        <div class="block-title">üéØ –ë–õ–û–ö 5: –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ</div>
                        <div class="block-score" id="block5Score">0 / 10</div>
                    </div>
                    <div class="info-box">
                        <strong>–ú–∏–Ω–∏–º—É–º –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</strong> ‚â•8 –±–∞–ª–ª–æ–≤
                    </div>
                    <div class="criteria-grid">
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç—É –º–∞–≥–∞–∑–∏–Ω–∞</div>
                                <div class="criterion-info">1-–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç, 5-–ø–æ–ª–Ω–æ—Å—Ç—å—é | –í–µ—Å: 4%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="storeFormat">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –ß–∞—Å—Ç–∏—á–Ω–æ</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –ü–æ–ª–Ω–æ—Å—Ç—å—é</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•4 = 4 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="storeFormatScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</div>
                                <div class="criterion-info">1-–Ω–µ –¥–æ–ø–æ–ª–Ω—è–µ—Ç, 5-–∏–¥–µ–∞–ª—å–Ω–æ | –í–µ—Å: 3%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="categoryFit">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –ù–µ –¥–æ–ø–æ–ª–Ω—è–µ—Ç</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –ß–∞—Å—Ç–∏—á–Ω–æ</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –ò–¥–µ–∞–ª—å–Ω–æ</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 3 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="categoryFitScore">0</div>
                        </div>
                        
                        <div class="criterion">
                            <div>
                                <div class="criterion-name">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫—Ä–æ—Å—Å-–ø—Ä–æ–¥–∞–∂</div>
                                <div class="criterion-info">1-–Ω–µ—Ç, 3-–µ—Å—Ç—å, 5-–≤—ã—Å–æ–∫–∞—è | –í–µ—Å: 3%</div>
                            </div>
                            <div class="criterion-input">
                                <select id="crossSell">
                                    <option value="0">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="1">1 - –ù–µ—Ç</option>
                                    <option value="2">2</option>
                                    <option value="3">3 - –ï—Å—Ç—å</option>
                                    <option value="4">4</option>
                                    <option value="5">5 - –í—ã—Å–æ–∫–∞—è</option>
                                </select>
                            </div>
                            <div class="criterion-info">‚â•3 = 3 –±–∞–ª–ª–∞</div>
                            <div class="criterion-score" id="crossSellScore">0</div>
                        </div>
                    </div>
                </div>
                
                <!-- –°—Ç–∏–º—É–ª–∏—Ä—É—é—â–∏–µ —É—Å–ª–æ–≤–∏—è -->
                <div class="conditions-section">
                    <h3>üéÅ –°—Ç–∏–º—É–ª–∏—Ä—É—é—â–∏–µ —É—Å–ª–æ–≤–∏—è –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>–õ–∏—Å—Ç–∏–Ω–≥–æ–≤—ã–π –±–æ–Ω—É—Å (—Ä—É–±)</label>
                            <input type="number" id="listingBonus" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>–†–µ—Ç—Ä–æ-–±–æ–Ω—É—Å –∑–∞ –æ–±—ä–µ–º (%)</label>
                            <input type="number" id="retroBonus" step="0.1" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (—Ä—É–±)</label>
                            <input type="number" id="marketingSupport" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>–¢–æ–≤–∞—Ä–Ω—ã–π –∫—Ä–µ–¥–∏—Ç (–¥–Ω–µ–π)</label>
                            <input type="number" id="creditDays" placeholder="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>–ü—Ä–æ–º–æ-—É—Å–ª–æ–≤–∏—è –∏ –ø—Ä–æ—á–∏–µ —É—Å–ª–æ–≤–∏—è</label>
                        <textarea id="promoConditions" rows="3" style="width: 100%; padding: 10px; border: 2px solid var(--color-border); border-radius: 8px; font-family: inherit;" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–º–æ-—É—Å–ª–æ–≤–∏–π –∏ –¥—Ä—É–≥–∏—Ö –æ—Å–æ–±—ã—Ö —É—Å–ª–æ–≤–∏–π"></textarea>
                    </div>
                    <div class="form-group">
                        <label>–û—Ü–µ–Ω–∫–∞ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —É—Å–ª–æ–≤–∏–π (1-10)</label>
                        <select id="conditionsRating" style="padding: 10px;">
                            <option value="0">–ù–µ –æ—Ü–µ–Ω–µ–Ω–æ</option>
                            <option value="1">1 - –û—á–µ–Ω—å –ø–ª–æ—Ö–∏–µ</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 - –°—Ä–µ–¥–Ω–∏–µ</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10 - –û—Ç–ª–∏—á–Ω—ã–µ</option>
                        </select>
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-calculate" onclick="calculate()">üîÑ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Ü–µ–Ω–∫—É</button>
                    <button class="btn btn-reset" onclick="resetForm()">‚úï –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</button>
                </div>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div>
                <div class="result-panel">
                    <h2>üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç–æ–≤–∞—Ä–∞</h2>
                    <div class="total-score" id="totalScore">0</div>
                    <div style="text-align: center; font-size: 14px; opacity: 0.9;">–∏–∑ 100 –±–∞–ª–ª–æ–≤</div>
                    
                    <div class="decision" id="decision">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ</div>
                    
                    <div class="block-scores">
                        <div class="block-score-item">
                            <span>üí∞ –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è</span>
                            <strong id="block1Result">0/43</strong>
                        </div>
                        <div class="block-score-item">
                            <span>üìà –†—ã–Ω–æ—á–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</span>
                            <strong id="block2Result">0/18</strong>
                        </div>
                        <div class="block-score-item">
                            <span>‚öôÔ∏è –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è</span>
                            <strong id="block3Result">0/17</strong>
                        </div>
                        <div class="block-score-item">
                            <span>üõ°Ô∏è –†–∏—Å–∫–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–æ</span>
                            <strong id="block4Result">0/12</strong>
                        </div>
                        <div class="block-score-item">
                            <span>üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è</span>
                            <strong id="block5Result">0/10</strong>
                        </div>
                    </div>
                    
                    <div class="legend" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.2);">
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--color-success);"></div>
                            <span style="font-size: 11px;">90-100: –û—Ç–ª–∏—á–Ω—ã–π —Ç–æ–≤–∞—Ä</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #3b82f6;"></div>
                            <span style="font-size: 11px;">75-89: –•–æ—Ä–æ—à–∏–π —Ç–æ–≤–∞—Ä</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--color-warning);"></div>
                            <span style="font-size: 11px;">60-74: –¢—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--color-danger);"></div>
                            <span style="font-size: 11px;">&lt;60: –û—Ç–∫–ª–æ–Ω–∏—Ç—å</span>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px; font-size: 12px;">
                    <h3 style="color: var(--color-primary); margin-bottom: 10px;">‚ÑπÔ∏è –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <p><strong>–§–æ—Ä–º—É–ª—ã:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>–¢–æ—Ä–≥–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ = (–†–æ–∑–Ω. —Ü–µ–Ω–∞ - –ó–∞–∫—É–ø. —Ü–µ–Ω–∞) / –ó–∞–∫—É–ø. —Ü–µ–Ω–∞ √ó 100%</li>
                        <li>–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å = (–í—ã—Ä—É—á–∫–∞ - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å) / –í—ã—Ä—É—á–∫–∞ √ó 100%</li>
                        <li>GMROI = –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å / –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø–∞—Å–æ–≤</li>
                    </ul>
                    <p style="margin-top: 15px;"><strong>–ü–æ—Ä–æ–≥–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>‚â•75 –±–∞–ª–ª–æ–≤ - –ü–†–ò–ù–Ø–¢–¨</li>
                        <li>60-74 –±–∞–ª–ª–∞ - –£–≥–ª—É–±–ª–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑</li>
                        <li>&lt;60 –±–∞–ª–ª–æ–≤ - –û–¢–ö–õ–û–ù–ò–¢–¨</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ Excel -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel</h2>
                <button class="modal-close" onclick="closeModal('importModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="file-upload" id="fileUpload">
                    <input type="file" id="excelFile" accept=".xlsx,.xls" style="display: none;" onchange="handleFileSelect(event)">
                    <div style="font-size: 48px; margin-bottom: 15px;">üìÅ</div>
                    <div style="font-size: 16px; font-weight: 600; margin-bottom: 10px;">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ Excel —Ñ–∞–π–ª —Å—é–¥–∞</div>
                    <div style="font-size: 14px; color: #666; margin-bottom: 20px;">–∏–ª–∏</div>
                    <button class="btn btn-calculate" onclick="document.getElementById('excelFile').click()" style="width: auto;">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</button>
                    <div style="margin-top: 20px; font-size: 12px; color: #666;">
                        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã: .xlsx, .xls<br>
                        –§–æ—Ä–º–∞—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü–æ—Å—Ç–∞–≤—â–∏–∫ | –ù–∞—Ü–µ–Ω–∫–∞ | –ú–∞—Ä–∂–∞ | GMROI | –∏ —Ç.–¥.
                    </div>
                </div>
                <div id="importResults" style="margin-top: 20px; display: none;">
                    <h3 style="color: var(--color-primary); margin-bottom: 15px;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–º–ø–æ—Ä—Ç–∞</h3>
                    <div id="importSummary"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
    <div id="userManagementModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                <button class="modal-close" onclick="closeModal('userManagementModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--color-primary); margin-bottom: 15px;">–ú–µ–Ω–µ–¥–∂–µ—Ä</h3>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="managerEmail" readonly style="background: #f0f0f0;">
                    </div>
                    <div class="form-group">
                        <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="managerPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å">
                    </div>
                    <button class="btn btn-calculate" onclick="updatePassword('manager')" style="width: 100%;">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞</button>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--color-primary); margin-bottom: 15px;">–î–∏—Ä–µ–∫—Ç–æ—Ä</h3>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="directorEmail" readonly style="background: #f0f0f0;">
                    </div>
                    <div class="form-group">
                        <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="directorPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å">
                    </div>
                    <button class="btn btn-calculate" onclick="updatePassword('director')" style="width: 100%;">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞</button>
                </div>
                
                <div style="background: #fff8dc; padding: 15px; border-radius: 8px; border: 2px solid #ffd700; font-size: 13px;">
                    <strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong> –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—É–¥–µ—Ç –≤–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ —Å –Ω–æ–≤—ã–º –ø–∞—Ä–æ–ª–µ–º.
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
    <div id="productsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –æ—Ü–µ–Ω–∫–µ</h2>
                <button class="modal-close" onclick="closeModal('productsModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn btn-calculate" onclick="filterProducts('all')" style="width: auto; font-size: 13px;">–í—Å–µ (<span id="countAll">0</span>)</button>
                    <button class="btn btn-calculate" onclick="filterProducts('approved')" style="width: auto; background: var(--color-success); font-size: 13px;">–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ (<span id="countApproved">0</span>)</button>
                    <button class="btn btn-calculate" onclick="filterProducts('pending')" style="width: auto; background: var(--color-warning); font-size: 13px;">–ù–∞ –æ—Ü–µ–Ω–∫–µ (<span id="countPending">0</span>)</button>
                    <button class="btn btn-calculate" onclick="filterProducts('rejected')" style="width: auto; background: var(--color-danger); font-size: 13px;">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ (<span id="countRejected">0</span>)</button>
                </div>
                <div style="max-height: 500px; overflow-y: auto;">
                    <table class="products-table">
                        <thead>
                            <tr>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th>
                                <th>–ë–∞–ª–ª</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="productsTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        let users = JSON.parse(localStorage.getItem('users') || '[{"email":"manager@store.ru","password":"pass123","name":"–ò–≤–∞–Ω –ú–µ–Ω–µ–¥–∂–µ—Ä–æ–≤","role":"manager"},{"email":"director@store.ru","password":"pass123","name":"–ü–µ—Ç—Ä –î–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤","role":"director"},{"email":"admin@store.ru","password":"pass123","name":"–ê–Ω–Ω–∞ –ê–¥–º–∏–Ω–æ–≤–∞","role":"admin"}]');
        
        let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
        let products = JSON.parse(localStorage.getItem('products') || '[]');
        let currentFilter = 'all';
        
        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.email === email && u.password === password);
            if (!user) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
                return;
            }
            
            currentUser = user;
            localStorage.setItem('currentUser', JSON.stringify(user));
            showMainApp();
        }
        
        function logout() {
            if (!confirm('–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã?')) return;
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }
        
        function showMainApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('currentUserName').textContent = currentUser.name;
            document.getElementById('currentUserRole').textContent = getRoleName(currentUser.role);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞
            if (currentUser.role === 'admin') {
                document.getElementById('userManagementBtn').style.display = 'inline-block';
            }
            
            updateProductsCount();
        }
        
        function showUserManagement() {
            const manager = users.find(u => u.role === 'manager');
            const director = users.find(u => u.role === 'director');
            
            document.getElementById('managerEmail').value = manager.email;
            document.getElementById('directorEmail').value = director.email;
            document.getElementById('managerPassword').value = '';
            document.getElementById('directorPassword').value = '';
            
            document.getElementById('userManagementModal').classList.add('active');
        }
        
        function updatePassword(role) {
            const passwordField = role === 'manager' ? 'managerPassword' : 'directorPassword';
            const newPassword = document.getElementById(passwordField).value.trim();
            
            if (!newPassword) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å');
                return;
            }
            
            if (newPassword.length < 6) {
                alert('‚ùå –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }
            
            const user = users.find(u => u.role === role);
            if (user) {
                user.password = newPassword;
                localStorage.setItem('users', JSON.stringify(users));
                alert('‚úÖ –ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω');
                document.getElementById(passwordField).value = '';
            }
        }
        
        function downloadApp() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'index.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('‚úÖ –§–∞–π–ª index.html —Å–∫–∞—á–∞–Ω! –¢–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∑–∏—Ç–µ –µ–≥–æ –Ω–∞ GitHub –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.');
        }
        
        function getRoleName(role) {
            const roles = {manager: '–ú–µ–Ω–µ–¥–∂–µ—Ä', director: '–î–∏—Ä–µ–∫—Ç–æ—Ä', admin: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'};
            return roles[role] || role;
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
        function showImportModal() {
            document.getElementById('importModal').classList.add('active');
        }
        
        function showProductsList() {
            updateProductsTable();
            document.getElementById('productsModal').classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        function showNewProductForm() {
            closeModal('productsModal');
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ Excel
        const fileUpload = document.getElementById('fileUpload');
        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.classList.add('dragover');
        });
        fileUpload.addEventListener('dragleave', () => fileUpload.classList.remove('dragover'));
        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) processExcelFile(file);
        });
        
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) processExcelFile(file);
        }
        
        function processExcelFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                    
                    let imported = 0;
                    jsonData.forEach(row => {
                        const product = {
                            id: Date.now() + Math.random(),
                            name: row['–ù–∞–∑–≤–∞–Ω–∏–µ'] || row['–¢–æ–≤–∞—Ä'] || '',
                            category: row['–ö–∞—Ç–µ–≥–æ—Ä–∏—è'] || '',
                            supplier: row['–ü–æ—Å—Ç–∞–≤—â–∏–∫'] || '',
                            markup: parseFloat(row['–ù–∞—Ü–µ–Ω–∫–∞']) || 0,
                            margin: parseFloat(row['–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å']) || 0,
                            gmroi: parseFloat(row['GMROI']) || 0,
                            volume: parseFloat(row['–û–±—ä–µ–º –ø—Ä–æ–¥–∞–∂']) || 0,
                            revenue: parseFloat(row['–í—ã—Ä—É—á–∫–∞']) || 0,
                            score: 0,
                            status: 'pending',
                            date: new Date().toLocaleDateString('ru-RU'),
                            addedBy: currentUser.name
                        };
                        if (product.name) {
                            products.push(product);
                            imported++;
                        }
                    });
                    
                    localStorage.setItem('products', JSON.stringify(products));
                    document.getElementById('importResults').style.display = 'block';
                    document.getElementById('importSummary').innerHTML = `
                        <div style="padding: 20px; background: #d1fae5; border-radius: 8px; border: 2px solid var(--color-success);">
                            <div style="font-size: 18px; font-weight: 700; color: var(--color-success); margin-bottom: 10px;">
                                ‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: ${imported} —Ç–æ–≤–∞—Ä–æ–≤
                            </div>
                            <div style="font-size: 14px; color: #666;">
                                –¢–æ–≤–∞—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ø–∏—Å–æ–∫ –Ω–∞ –æ—Ü–µ–Ω–∫—É. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞.
                            </div>
                        </div>
                    `;
                    updateProductsCount();
                    setTimeout(() => closeModal('importModal'), 3000);
                } catch (error) {
                    alert('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞: ' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º —Ç–æ–≤–∞—Ä–æ–≤
        function updateProductsCount() {
            document.getElementById('productsCount').textContent = products.length;
            document.getElementById('countAll').textContent = products.length;
            document.getElementById('countApproved').textContent = products.filter(p => p.status === 'approved').length;
            document.getElementById('countPending').textContent = products.filter(p => p.status === 'pending').length;
            document.getElementById('countRejected').textContent = products.filter(p => p.status === 'rejected').length;
        }
        
        function filterProducts(status) {
            currentFilter = status;
            updateProductsTable();
        }
        
        function updateProductsTable() {
            const tbody = document.getElementById('productsTableBody');
            const filtered = currentFilter === 'all' ? products : products.filter(p => p.status === currentFilter);
            
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #999;">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
                return;
            }
            
            tbody.innerHTML = filtered.map(p => `
                <tr>
                    <td><strong>${p.name}</strong></td>
                    <td>${p.category}</td>
                    <td>${p.supplier}</td>
                    <td><strong>${p.score}</strong></td>
                    <td><span class="status-badge status-${p.status}">${getStatusName(p.status)}</span></td>
                    <td>${p.date}</td>
                    <td>
                        <button onclick="editProduct('${p.id}')" style="padding: 4px 8px; border: none; background: #3b82f6; color: white; border-radius: 4px; cursor: pointer; font-size: 11px;">–û—Ç–∫—Ä—ã—Ç—å</button>
                        ${canApprove() && p.status === 'pending' ? `<button onclick="approveProduct('${p.id}')" style="padding: 4px 8px; border: none; background: var(--color-success); color: white; border-radius: 4px; cursor: pointer; font-size: 11px; margin-left: 5px;">–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å</button>` : ''}
                        ${canApprove() && p.status === 'pending' ? `<button onclick="rejectProduct('${p.id}')" style="padding: 4px 8px; border: none; background: var(--color-danger); color: white; border-radius: 4px; cursor: pointer; font-size: 11px; margin-left: 5px;">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>` : ''}
                    </td>
                </tr>
            `).join('');
        }
        
        function getStatusName(status) {
            const names = {approved: '–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ', pending: '–ù–∞ –æ—Ü–µ–Ω–∫–µ', rejected: '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ'};
            return names[status] || status;
        }
        
        function canApprove() {
            return currentUser && (currentUser.role === 'director' || currentUser.role === 'admin');
        }
        
        function editProduct(id) {
            const product = products.find(p => p.id == id);
            if (product) {
                document.getElementById('productName').value = product.name;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('supplierName').value = product.supplier;
                document.getElementById('markup').value = product.markup;
                document.getElementById('margin').value = product.margin;
                document.getElementById('gmroi').value = product.gmroi;
                document.getElementById('volume').value = product.volume;
                document.getElementById('revenue').value = product.revenue;
                closeModal('productsModal');
                calculate();
            }
        }
        
        function approveProduct(id) {
            const product = products.find(p => p.id == id);
            if (product) {
                product.status = 'approved';
                product.approvedBy = currentUser.name;
                product.approvedDate = new Date().toLocaleDateString('ru-RU');
                localStorage.setItem('products', JSON.stringify(products));
                updateProductsTable();
                updateProductsCount();
            }
        }
        
        function rejectProduct(id) {
            const reason = prompt('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è:');
            if (!reason) return;
            const product = products.find(p => p.id == id);
            if (product) {
                product.status = 'rejected';
                product.rejectedBy = currentUser.name;
                product.rejectedReason = reason;
                product.rejectedDate = new Date().toLocaleDateString('ru-RU');
                localStorage.setItem('products', JSON.stringify(products));
                updateProductsTable();
                updateProductsCount();
            }
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
        function exportToExcel() {
            const ws = XLSX.utils.json_to_sheet(products.map(p => ({
                '–ù–∞–∑–≤–∞–Ω–∏–µ': p.name,
                '–ö–∞—Ç–µ–≥–æ—Ä–∏—è': p.category,
                '–ü–æ—Å—Ç–∞–≤—â–∏–∫': p.supplier,
                '–ù–∞—Ü–µ–Ω–∫–∞': p.markup,
                '–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å': p.margin,
                'GMROI': p.gmroi,
                '–û–±—ä–µ–º': p.volume,
                '–í—ã—Ä—É—á–∫–∞': p.revenue,
                '–ë–∞–ª–ª': p.score,
                '–°—Ç–∞—Ç—É—Å': getStatusName(p.status),
                '–î–∞—Ç–∞': p.date,
                '–î–æ–±–∞–≤–∏–ª': p.addedBy
            })));
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, '–¢–æ–≤–∞—Ä—ã');
            XLSX.writeFile(wb, `—Ç–æ–≤–∞—Ä—ã_–æ—Ü–µ–Ω–∫–∞_${new Date().toLocaleDateString('ru-RU')}.xlsx`);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        if (currentUser) {
            showMainApp();
        }
        
        function calculate() {
            let totalScore = 0;
            
            // –ë–õ–û–ö 1: –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (43 –±–∞–ª–ª–∞)
            let block1 = 0;
            
            const markup = parseFloat(document.getElementById('markup').value) || 0;
            const markupScore = markup >= 30 ? 10 : 0;
            document.getElementById('markupScore').textContent = markupScore;
            block1 += markupScore;
            
            const margin = parseFloat(document.getElementById('margin').value) || 0;
            const marginScore = margin >= 15 ? 10 : 0;
            document.getElementById('marginScore').textContent = marginScore;
            block1 += marginScore;
            
            const gmroi = parseFloat(document.getElementById('gmroi').value) || 0;
            const gmroiScore = gmroi >= 1.5 ? 8 : 0;
            document.getElementById('gmroiScore').textContent = gmroiScore;
            block1 += gmroiScore;
            
            const volume = parseFloat(document.getElementById('volume').value) || 0;
            const volumeScore = volume >= 150 ? 7 : 0;
            document.getElementById('volumeScore').textContent = volumeScore;
            block1 += volumeScore;
            
            const revenue = parseFloat(document.getElementById('revenue').value) || 0;
            const revenueScore = revenue >= 25000 ? 8 : 0;
            document.getElementById('revenueScore').textContent = revenueScore;
            block1 += revenueScore;
            
            document.getElementById('block1Score').textContent = block1 + ' / 43';
            document.getElementById('block1Score').className = 'block-score ' + (block1 >= 35 ? 'pass' : 'fail');
            document.getElementById('block1Result').textContent = block1 + '/43';
            totalScore += block1;
            
            // –ë–õ–û–ö 2: –†—ã–Ω–æ—á–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (18 –±–∞–ª–ª–æ–≤)
            let block2 = 0;
            
            const marketCapacity = parseInt(document.getElementById('marketCapacity').value) || 0;
            const marketCapacityScore = marketCapacity >= 3 ? 5 : 0;
            document.getElementById('marketCapacityScore').textContent = marketCapacityScore;
            block2 += marketCapacityScore;
            
            const demand = parseInt(document.getElementById('demand').value) || 0;
            const demandScore = demand >= 3 ? 6 : 0;
            document.getElementById('demandScore').textContent = demandScore;
            block2 += demandScore;
            
            const uniqueness = parseInt(document.getElementById('uniqueness').value) || 0;
            const uniquenessScore = uniqueness >= 3 ? 4 : 0;
            document.getElementById('uniquenessScore').textContent = uniquenessScore;
            block2 += uniquenessScore;
            
            const competition = parseInt(document.getElementById('competition').value) || 0;
            const competitionScore = competition >= 3 ? 3 : 0;
            document.getElementById('competitionScore').textContent = competitionScore;
            block2 += competitionScore;
            
            document.getElementById('block2Score').textContent = block2 + ' / 18';
            document.getElementById('block2Score').className = 'block-score ' + (block2 >= 12 ? 'pass' : 'fail');
            document.getElementById('block2Result').textContent = block2 + '/18';
            totalScore += block2;
            
            // –ë–õ–û–ö 3: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (17 –±–∞–ª–ª–æ–≤)
            let block3 = 0;
            
            const shelfLife = parseFloat(document.getElementById('shelfLife').value) || 0;
            const shelfLifeScore = shelfLife >= 14 ? 4 : 0;
            document.getElementById('shelfLifeScore').textContent = shelfLifeScore;
            block3 += shelfLifeScore;
            
            const supplierReliability = parseInt(document.getElementById('supplierReliability').value) || 0;
            const supplierReliabilityScore = supplierReliability >= 7 ? 5 : 0;
            document.getElementById('supplierReliabilityScore').textContent = supplierReliabilityScore;
            block3 += supplierReliabilityScore;
            
            const deliveryTerms = parseInt(document.getElementById('deliveryTerms').value) || 0;
            const deliveryTermsScore = deliveryTerms >= 3 ? 3 : 0;
            document.getElementById('deliveryTermsScore').textContent = deliveryTermsScore;
            block3 += deliveryTermsScore;
            
            const turnover = parseFloat(document.getElementById('turnover').value) || 999;
            const turnoverScore = turnover <= 30 ? 5 : 0;
            document.getElementById('turnoverScore').textContent = turnoverScore;
            block3 += turnoverScore;
            
            document.getElementById('block3Score').textContent = block3 + ' / 17';
            document.getElementById('block3Score').className = 'block-score ' + (block3 >= 12 ? 'pass' : 'fail');
            document.getElementById('block3Result').textContent = block3 + '/17';
            totalScore += block3;
            
            // –ë–õ–û–ö 4: –†–∏—Å–∫–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–æ (12 –±–∞–ª–ª–æ–≤)
            let block4 = 0;
            
            const brandReputation = parseInt(document.getElementById('brandReputation').value) || 0;
            const brandReputationScore = brandReputation >= 3 ? 4 : 0;
            document.getElementById('brandReputationScore').textContent = brandReputationScore;
            block4 += brandReputationScore;
            
            const certification = parseInt(document.getElementById('certification').value) || 0;
            const certificationScore = certification === 5 ? 5 : 0;
            document.getElementById('certificationScore').textContent = certificationScore;
            block4 += certificationScore;
            
            const spoilageRisk = parseInt(document.getElementById('spoilageRisk').value) || 0;
            const spoilageRiskScore = spoilageRisk >= 3 ? 3 : 0;
            document.getElementById('spoilageRiskScore').textContent = spoilageRiskScore;
            block4 += spoilageRiskScore;
            
            document.getElementById('block4Score').textContent = block4 + ' / 12';
            document.getElementById('block4Score').className = 'block-score ' + (block4 >= 9 ? 'pass' : 'fail');
            document.getElementById('block4Result').textContent = block4 + '/12';
            totalScore += block4;
            
            // –ë–õ–û–ö 5: –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ (10 –±–∞–ª–ª–æ–≤)
            let block5 = 0;
            
            const storeFormat = parseInt(document.getElementById('storeFormat').value) || 0;
            const storeFormatScore = storeFormat >= 4 ? 4 : 0;
            document.getElementById('storeFormatScore').textContent = storeFormatScore;
            block5 += storeFormatScore;
            
            const categoryFit = parseInt(document.getElementById('categoryFit').value) || 0;
            const categoryFitScore = categoryFit >= 3 ? 3 : 0;
            document.getElementById('categoryFitScore').textContent = categoryFitScore;
            block5 += categoryFitScore;
            
            const crossSell = parseInt(document.getElementById('crossSell').value) || 0;
            const crossSellScore = crossSell >= 3 ? 3 : 0;
            document.getElementById('crossSellScore').textContent = crossSellScore;
            block5 += crossSellScore;
            
            document.getElementById('block5Score').textContent = block5 + ' / 10';
            document.getElementById('block5Score').className = 'block-score ' + (block5 >= 8 ? 'pass' : 'fail');
            document.getElementById('block5Result').textContent = block5 + '/10';
            totalScore += block5;
            
            // –ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª
            document.getElementById('totalScore').textContent = totalScore;
            
            // –†–µ—à–µ–Ω–∏–µ
            const decisionEl = document.getElementById('decision');
            if (totalScore >= 90) {
                decisionEl.textContent = '‚úÖ –ü–†–ò–ù–Ø–¢–¨ (–û—Ç–ª–∏—á–Ω—ã–π —Ç–æ–≤–∞—Ä)';
                decisionEl.className = 'decision accept';
            } else if (totalScore >= 75) {
                decisionEl.textContent = '‚úÖ –ü–†–ò–ù–Ø–¢–¨ (–•–æ—Ä–æ—à–∏–π —Ç–æ–≤–∞—Ä)';
                decisionEl.className = 'decision accept';
            } else if (totalScore >= 60) {
                decisionEl.textContent = '‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –ê–ù–ê–õ–ò–ó–ê';
                decisionEl.className = 'decision review';
            } else {
                decisionEl.textContent = '‚ùå –û–¢–ö–õ–û–ù–ò–¢–¨';
                decisionEl.className = 'decision reject';
            }
        }
        
        function resetForm() {
            if (!confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã?')) return;
            document.querySelectorAll('input, select, textarea').forEach(el => {
                if (el.type === 'number' || el.type === 'text' || el.tagName === 'TEXTAREA') {
                    el.value = '';
                } else if (el.tagName === 'SELECT') {
                    el.selectedIndex = 0;
                }
            });
            document.querySelectorAll('.criterion-score').forEach(el => el.textContent = '0');
            document.getElementById('totalScore').textContent = '0';
            document.getElementById('decision').textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ';
            document.getElementById('decision').className = 'decision';
            document.querySelectorAll('.block-score').forEach(el => {
                el.className = 'block-score';
            });
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
        document.querySelectorAll('input, select').forEach(el => {
            el.addEventListener('change', calculate);
        });
    </script>
</body>
</html>
